!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.SirTrevor=t()}}(function(){var t;return function e(t,n,o){function i(r,a){if(!n[r]){if(!t[r]){var l="function"==typeof require&&require;if(!a&&l)return l(r,!0);if(s)return s(r,!0);var c=new Error("Cannot find module '"+r+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[r]={exports:{}};t[r][0].call(d.exports,function(e){var n=t[r][1][e];return i(n?n:e)},d,d.exports,e,t,n,o)}return n[r].exports}for(var s="function"==typeof require&&require,r=0;r<o.length;r++)i(o[r]);return i}({1:[function(t,e){e.exports=t("./src/")},{"./src/":95}],2:[function(){!function(){if(!Array.prototype.find){var t=function(t){var e=Object(this),n=e.length<0?0:e.length>>>0;if(0===n)return void 0;if("function"!=typeof t||"[object Function]"!==Object.prototype.toString.call(t))throw new TypeError("Array#find: predicate must be a function");for(var o,i=arguments[1],s=0;n>s;s++)if(o=e[s],t.call(i,o,s,e))return o;return void 0};if(Object.defineProperty)try{Object.defineProperty(Array.prototype,"find",{value:t,configurable:!0,enumerable:!1,writable:!0})}catch(e){}Array.prototype.find||(Array.prototype.find=t)}}(this)},{}],3:[function(e,n,o){!function(e,i){"function"==typeof t&&t.amd?t("eventable",function(){return e.Eventable=i()}):"undefined"!=typeof o?n.exports=i():e.Eventable=i()}(this,function(){function t(t){var e,n=2;return function(){return--n>0?e=t.apply(this,arguments):t=null,e}}function e(t,e){i[t]=function(t,n,o){var i=this._listeners||(this._listeners={}),s=t._listenerId||(t._listenerId=(new Date).getTime());return i[s]=t,"object"==typeof n&&(o=this),t[e](n,o,this),this}}var n=[],o=n.slice,i={on:function(t,e,n){if(!r(this,"on",t,[e,n])||!e)return this;this._events||(this._events={});var o=this._events[t]||(this._events[t]=[]);return o.push({callback:e,context:n,ctx:n||this}),this},once:function(e,n,o){if(!r(this,"once",e,[n,o])||!n)return this;var i=this,s=t(function(){i.off(e,s),n.apply(this,arguments)});return s._callback=n,this.on(e,s,o)},off:function(t,e,n){var o,i,s,a,l,c,d,u;if(!this._events||!r(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._events={},this;for(a=t?[t]:Object.keys(this._events),l=0,c=a.length;c>l;l++)if(t=a[l],s=this._events[t]){if(this._events[t]=o=[],e||n)for(d=0,u=s.length;u>d;d++)i=s[d],(e&&e!==i.callback&&e!==i.callback._callback||n&&n!==i.context)&&o.push(i);o.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=o.call(arguments,1);if(!r(this,"trigger",t,e))return this;var n=this._events[t],i=this._events.all;return n&&a(n,e),i&&a(i,arguments),this},stopListening:function(t,e,n){var o=this._listeners;if(!o)return this;var i=!e&&!n;"object"==typeof e&&(n=this),t&&((o={})[t._listenerId]=t);for(var s in o)o[s].off(e,n,this),i&&delete this._listeners[s];return this}},s=/\s+/,r=function(t,e,n,o){if(!n)return!0;if("object"==typeof n){for(var i in n)t[e].apply(t,[i,n[i]].concat(o));return!1}if(s.test(n)){for(var r=n.split(s),a=0,l=r.length;l>a;a++)t[e].apply(t,[r[a]].concat(o));return!1}return!0},a=function(t,e){var n,o=-1,i=t.length,s=e[0],r=e[1],a=e[2];switch(e.length){case 0:for(;++o<i;)(n=t[o]).callback.call(n.ctx);return;case 1:for(;++o<i;)(n=t[o]).callback.call(n.ctx,s);return;case 2:for(;++o<i;)(n=t[o]).callback.call(n.ctx,s,r);return;case 3:for(;++o<i;)(n=t[o]).callback.call(n.ctx,s,r,a);return;default:for(;++o<i;)(n=t[o]).callback.apply(n.ctx,e)}};return e("listenTo","on"),e("listenToOnce","once"),i.bind=i.on,i.unbind=i.off,i})},{}],4:[function(t,e){function n(t){var e=!0;if(!t)return e;var n=d.call(t),c=t.length;return n==r||n==l||n==s||n==a&&"number"==typeof c&&i(t.splice)?!c:(o(t,function(){return e=!1}),e)}var o=t("lodash.forown"),i=t("lodash.isfunction"),s="[object Arguments]",r="[object Array]",a="[object Object]",l="[object String]",c=Object.prototype,d=c.toString;e.exports=n},{"lodash.forown":5,"lodash.isfunction":28}],5:[function(t,e){var n=t("lodash._basecreatecallback"),o=t("lodash.keys"),i=t("lodash._objecttypes"),s=function(t,e,s){var r,a=t,l=a;if(!a)return l;if(!i[typeof a])return l;e=e&&"undefined"==typeof s?e:n(e,s,3);for(var c=-1,d=i[typeof a]&&o(a),u=d?d.length:0;++c<u;)if(r=d[c],e(a[r],r,t)===!1)return l;return l};e.exports=s},{"lodash._basecreatecallback":6,"lodash._objecttypes":24,"lodash.keys":25}],6:[function(t,e){function n(t,e,n){if("function"!=typeof t)return i;if("undefined"==typeof e||!("prototype"in t))return t;var d=t.__bindData__;if("undefined"==typeof d&&(r.funcNames&&(d=!t.name),d=d||!r.funcDecomp,!d)){var u=c.call(t);r.funcNames||(d=!a.test(u)),d||(d=l.test(u),s(t,d))}if(d===!1||d!==!0&&1&d[1])return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,o){return t.call(e,n,o)};case 3:return function(n,o,i){return t.call(e,n,o,i)};case 4:return function(n,o,i,s){return t.call(e,n,o,i,s)}}return o(t,e)}var o=t("lodash.bind"),i=t("lodash.identity"),s=t("lodash._setbinddata"),r=t("lodash.support"),a=/^\s*function[ \n\r\t]+\w/,l=/\bthis\b/,c=Function.prototype.toString;e.exports=n},{"lodash._setbinddata":7,"lodash.bind":10,"lodash.identity":21,"lodash.support":22}],7:[function(t,e){var n=t("lodash._isnative"),o=t("lodash.noop"),i={configurable:!1,enumerable:!1,value:null,writable:!1},s=function(){try{var t={},e=n(e=Object.defineProperty)&&e,o=e(t,t,t)&&e}catch(i){}return o}(),r=s?function(t,e){i.value=e,s(t,"__bindData__",i)}:o;e.exports=r},{"lodash._isnative":8,"lodash.noop":9}],8:[function(t,e){function n(t){return"function"==typeof t&&s.test(t)}var o=Object.prototype,i=o.toString,s=RegExp("^"+String(i).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$");e.exports=n},{}],9:[function(t,e){function n(){}e.exports=n},{}],10:[function(t,e){function n(t,e){return arguments.length>2?o(t,17,i(arguments,2),null,e):o(t,1,null,null,e)}var o=t("lodash._createwrapper"),i=t("lodash._slice");e.exports=n},{"lodash._createwrapper":11,"lodash._slice":20}],11:[function(t,e){function n(t,e,a,d,u,h){var f=1&e,p=2&e,b=4&e,m=16&e,g=32&e;if(!p&&!s(t))throw new TypeError;m&&!a.length&&(e&=-17,m=a=!1),g&&!d.length&&(e&=-33,g=d=!1);var v=t&&t.__bindData__;if(v&&v!==!0)return v=r(v),v[2]&&(v[2]=r(v[2])),v[3]&&(v[3]=r(v[3])),!f||1&v[1]||(v[4]=u),!f&&1&v[1]&&(e|=8),!b||4&v[1]||(v[5]=h),m&&l.apply(v[2]||(v[2]=[]),a),g&&c.apply(v[3]||(v[3]=[]),d),v[1]|=e,n.apply(null,v);var k=1==e||17===e?o:i;return k([t,e,a,d,u,h])}var o=t("lodash._basebind"),i=t("lodash._basecreatewrapper"),s=t("lodash.isfunction"),r=t("lodash._slice"),a=[],l=a.push,c=a.unshift;e.exports=n},{"lodash._basebind":12,"lodash._basecreatewrapper":16,"lodash._slice":20,"lodash.isfunction":28}],12:[function(t,e){function n(t){function e(){if(a){var t=r(a);l.apply(t,arguments)}if(this instanceof e){var s=o(n.prototype),d=n.apply(s,t||arguments);return i(d)?d:s}return n.apply(c,t||arguments)}var n=t[0],a=t[2],c=t[4];return s(e,t),e}var o=t("lodash._basecreate"),i=t("lodash.isobject"),s=t("lodash._setbinddata"),r=t("lodash._slice"),a=[],l=a.push;e.exports=n},{"lodash._basecreate":13,"lodash._setbinddata":7,"lodash._slice":20,"lodash.isobject":29}],13:[function(t,e){(function(n){function o(t){return s(t)?r(t):{}}var i=t("lodash._isnative"),s=t("lodash.isobject"),r=(t("lodash.noop"),i(r=Object.create)&&r);r||(o=function(){function t(){}return function(e){if(s(e)){t.prototype=e;var o=new t;t.prototype=null}return o||n.Object()}}()),e.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"lodash._isnative":14,"lodash.isobject":29,"lodash.noop":15}],14:[function(t,e){e.exports=t(8)},{"/Users/andrewwalker/sites/sir-trevor-js/node_modules/lodash.isempty/node_modules/lodash.forown/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/node_modules/lodash._isnative/index.js":8}],15:[function(t,e){e.exports=t(9)},{"/Users/andrewwalker/sites/sir-trevor-js/node_modules/lodash.isempty/node_modules/lodash.forown/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/node_modules/lodash.noop/index.js":9}],16:[function(t,e){function n(t){function e(){var t=p?h:this;if(d){var s=r(d);l.apply(s,arguments)}if((u||m)&&(s||(s=r(arguments)),u&&l.apply(s,u),m&&s.length<f))return c|=16,n([a,g?c:-4&c,s,null,h,f]);if(s||(s=arguments),b&&(a=t[v]),this instanceof e){t=o(a.prototype);var k=a.apply(t,s);return i(k)?k:t}return a.apply(t,s)}var a=t[0],c=t[1],d=t[2],u=t[3],h=t[4],f=t[5],p=1&c,b=2&c,m=4&c,g=8&c,v=a;return s(e,t),e}var o=t("lodash._basecreate"),i=t("lodash.isobject"),s=t("lodash._setbinddata"),r=t("lodash._slice"),a=[],l=a.push;e.exports=n},{"lodash._basecreate":17,"lodash._setbinddata":7,"lodash._slice":20,"lodash.isobject":29}],17:[function(t,e){e.exports=t(13)},{"/Users/andrewwalker/sites/sir-trevor-js/node_modules/lodash.isempty/node_modules/lodash.forown/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash._basebind/node_modules/lodash._basecreate/index.js":13,"lodash._isnative":18,"lodash.isobject":29,"lodash.noop":19}],18:[function(t,e){e.exports=t(8)},{"/Users/andrewwalker/sites/sir-trevor-js/node_modules/lodash.isempty/node_modules/lodash.forown/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/node_modules/lodash._isnative/index.js":8}],19:[function(t,e){e.exports=t(9)},{"/Users/andrewwalker/sites/sir-trevor-js/node_modules/lodash.isempty/node_modules/lodash.forown/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/node_modules/lodash.noop/index.js":9}],20:[function(t,e){function n(t,e,n){e||(e=0),"undefined"==typeof n&&(n=t?t.length:0);for(var o=-1,i=n-e||0,s=Array(0>i?0:i);++o<i;)s[o]=t[e+o];return s}e.exports=n},{}],21:[function(t,e){function n(t){return t}e.exports=n},{}],22:[function(t,e){(function(n){var o=t("lodash._isnative"),i=/\bthis\b/,s={};s.funcDecomp=!o(n.WinRTError)&&i.test(function(){return this}),s.funcNames="string"==typeof Function.name,e.exports=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"lodash._isnative":23}],23:[function(t,e){e.exports=t(8)},{"/Users/andrewwalker/sites/sir-trevor-js/node_modules/lodash.isempty/node_modules/lodash.forown/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/node_modules/lodash._isnative/index.js":8}],24:[function(t,e){var n={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1};e.exports=n},{}],25:[function(t,e){var n=t("lodash._isnative"),o=t("lodash.isobject"),i=t("lodash._shimkeys"),s=n(s=Object.keys)&&s,r=s?function(t){return o(t)?s(t):[]}:i;e.exports=r},{"lodash._isnative":26,"lodash._shimkeys":27,"lodash.isobject":29}],26:[function(t,e){e.exports=t(8)},{"/Users/andrewwalker/sites/sir-trevor-js/node_modules/lodash.isempty/node_modules/lodash.forown/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/node_modules/lodash._isnative/index.js":8}],27:[function(t,e){var n=t("lodash._objecttypes"),o=Object.prototype,i=o.hasOwnProperty,s=function(t){var e,o=t,s=[];if(!o)return s;if(!n[typeof t])return s;for(e in o)i.call(o,e)&&s.push(e);return s};e.exports=s},{"lodash._objecttypes":24}],28:[function(t,e){function n(t){return"function"==typeof t}e.exports=n},{}],29:[function(t,e){function n(t){return!(!t||!o[typeof t])}var o=t("lodash._objecttypes");e.exports=n},{"lodash._objecttypes":30}],30:[function(t,e){e.exports=t(24)},{"/Users/andrewwalker/sites/sir-trevor-js/node_modules/lodash.isempty/node_modules/lodash.forown/node_modules/lodash._objecttypes/index.js":24}],31:[function(t,e){function n(t){return"string"==typeof t||t&&"object"==typeof t&&s.call(t)==o||!1}var o="[object String]",i=Object.prototype,s=i.toString;e.exports=n},{}],32:[function(t,e){function n(t){return"undefined"==typeof t}e.exports=n},{}],33:[function(t,e){function n(t,e){if(t){var n=t[e];return o(n)?t[e]():n}}var o=t("lodash.isfunction");e.exports=n},{"lodash.isfunction":28}],34:[function(t,e){function n(t,e,n){var b=a.imports._.templateSettings||a;t=String(t||""),n=o({},n,b);var m,g=o({},n.imports,b.imports),v=s(g),k=l(g),_=0,y=n.interpolate||f,w="__p += '",x=RegExp((n.escape||f).source+"|"+y.source+"|"+(y===r?h:f).source+"|"+(n.evaluate||f).source+"|$","g");t.replace(x,function(e,n,o,s,r,a){return o||(o=s),w+=t.slice(_,a).replace(p,i),n&&(w+="' +\n__e("+n+") +\n'"),r&&(m=!0,w+="';\n"+r+";\n__p += '"),o&&(w+="' +\n((__t = ("+o+")) == null ? '' : __t) +\n'"),_=a+e.length,e}),w+="';\n";var $=n.variable,B=$;B||($="obj",w="with ("+$+") {\n"+w+"\n}\n"),w=(m?w.replace(c,""):w).replace(d,"$1").replace(u,"$1;"),w="function("+$+") {\n"+(B?"":$+" || ("+$+" = {});\n")+"var __t, __p = '', __e = _.escape"+(m?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+w+"return __p\n}";try{var j=Function(v,"return "+w).apply(void 0,k)}catch(C){throw C.source=w,C}return e?j(e):(j.source=w,j)}var o=t("lodash.defaults"),i=(t("lodash.escape"),t("lodash._escapestringchar")),s=t("lodash.keys"),r=t("lodash._reinterpolate"),a=t("lodash.templatesettings"),l=t("lodash.values"),c=/\b__p \+= '';/g,d=/\b(__p \+=) '' \+/g,u=/(__e\(.*?\)|\b__t\)) \+\n'';/g,h=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,f=/($^)/,p=/['\n\r\t\u2028\u2029\\]/g;e.exports=n},{"lodash._escapestringchar":35,"lodash._reinterpolate":36,"lodash.defaults":37,"lodash.escape":39,"lodash.keys":44,"lodash.templatesettings":48,"lodash.values":49}],35:[function(t,e){function n(t){return"\\"+o[t]}var o={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"};e.exports=n},{}],36:[function(t,e){var n=/<%=([\s\S]+?)%>/g;e.exports=n},{}],37:[function(t,e){var n=t("lodash.keys"),o=t("lodash._objecttypes"),i=function(t,e,i){var s,r=t,a=r;if(!r)return a;for(var l=arguments,c=0,d="number"==typeof i?2:l.length;++c<d;)if(r=l[c],r&&o[typeof r])for(var u=-1,h=o[typeof r]&&n(r),f=h?h.length:0;++u<f;)s=h[u],"undefined"==typeof a[s]&&(a[s]=r[s]);return a};e.exports=i},{"lodash._objecttypes":38,"lodash.keys":44}],38:[function(t,e){e.exports=t(24)},{"/Users/andrewwalker/sites/sir-trevor-js/node_modules/lodash.isempty/node_modules/lodash.forown/node_modules/lodash._objecttypes/index.js":24}],39:[function(t,e){function n(t){return null==t?"":String(t).replace(i,o)}var o=t("lodash._escapehtmlchar"),i=(t("lodash.keys"),t("lodash._reunescapedhtml"));e.exports=n},{"lodash._escapehtmlchar":40,"lodash._reunescapedhtml":42,"lodash.keys":44}],40:[function(t,e){function n(t){return o[t]}var o=t("lodash._htmlescapes");e.exports=n},{"lodash._htmlescapes":41}],41:[function(t,e){var n={"&":"&","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};e.exports=n},{}],42:[function(t,e){var n=t("lodash._htmlescapes"),o=t("lodash.keys"),i=RegExp("["+o(n).join("")+"]","g");e.exports=i},{"lodash._htmlescapes":43,"lodash.keys":44}],43:[function(t,e){e.exports=t(41)},{"/Users/andrewwalker/sites/sir-trevor-js/node_modules/lodash.template/node_modules/lodash.escape/node_modules/lodash._escapehtmlchar/node_modules/lodash._htmlescapes/index.js":41}],44:[function(t,e){e.exports=t(25)},{"/Users/andrewwalker/sites/sir-trevor-js/node_modules/lodash.isempty/node_modules/lodash.forown/node_modules/lodash.keys/index.js":25,"lodash._isnative":45,"lodash._shimkeys":46,"lodash.isobject":29}],45:[function(t,e){e.exports=t(8)},{"/Users/andrewwalker/sites/sir-trevor-js/node_modules/lodash.isempty/node_modules/lodash.forown/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/node_modules/lodash._isnative/index.js":8}],46:[function(t,e){e.exports=t(27)},{"/Users/andrewwalker/sites/sir-trevor-js/node_modules/lodash.isempty/node_modules/lodash.forown/node_modules/lodash.keys/node_modules/lodash._shimkeys/index.js":27,"lodash._objecttypes":47}],47:[function(t,e){e.exports=t(24)},{"/Users/andrewwalker/sites/sir-trevor-js/node_modules/lodash.isempty/node_modules/lodash.forown/node_modules/lodash._objecttypes/index.js":24}],48:[function(t,e){var n=t("lodash.escape"),o=t("lodash._reinterpolate"),i={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:o,variable:"",imports:{_:{escape:n}}};e.exports=i},{"lodash._reinterpolate":36,"lodash.escape":39}],49:[function(t,e){function n(t){for(var e=-1,n=o(t),i=n.length,s=Array(i);++e<i;)s[e]=t[n[e]];return s}var o=t("lodash.keys");e.exports=n},{"lodash.keys":44}],50:[function(t,e){function n(t){var e=++o;return String(null==t?"":t)+e}var o=0;e.exports=n},{}],51:[function(t,e){"use strict";var n=t("object-keys"),o=function(t){return"undefined"!=typeof t&&null!==t},i=function(t){if(!o(t))throw new TypeError("target must be an object");var e,i,s,r,a=Object(t);for(e=1;e<arguments.length;++e)for(i=Object(arguments[e]),r=n(i),s=0;s<r.length;++s)a[r[s]]=i[r[s]];return a};i.shim=function(){return Object.assign||(Object.assign=i),Object.assign||i},e.exports=i},{"object-keys":52}],52:[function(t,e){"use strict";var n=Object.prototype.hasOwnProperty,o=Object.prototype.toString,i=t("./isArguments"),s=!{toString:null}.propertyIsEnumerable("toString"),r=function(){}.propertyIsEnumerable("prototype"),a=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],l=function(t){var e=null!==t&&"object"==typeof t,l="[object Function]"===o.call(t),c=i(t),d=e&&"[object String]"===o.call(t),u=[];if(!e&&!l&&!c)throw new TypeError("Object.keys called on a non-object");var h=r&&l;if(d&&t.length>0&&!n.call(t,0))for(var f=0;f<t.length;++f)u.push(String(f));if(c&&t.length>0)for(var p=0;p<t.length;++p)u.push(String(p));else for(var b in t)h&&"prototype"===b||!n.call(t,b)||u.push(String(b));if(s)for(var m=t.constructor,g=m&&m.prototype===t,p=0;p<a.length;++p)g&&"constructor"===a[p]||!n.call(t,a[p])||u.push(a[p]);return u};l.shim=function(){return Object.keys||(Object.keys=l),Object.keys||l},e.exports=l},{"./isArguments":53}],53:[function(t,e){"use strict";var n=Object.prototype.toString;e.exports=function o(t){var e=n.call(t),o="[object Arguments]"===e;return o||(o="[object Array]"!==e&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===n.call(t.callee)),o}},{}],54:[function(e,n,o){!function(e,i){"object"==typeof o?n.exports=i():"function"==typeof t&&t.amd?t(i):e.Spinner=i()}(this,function(){"use strict";function t(t,e){var n,o=document.createElement(t||"div");for(n in e)o[n]=e[n];return o}function e(t){for(var e=1,n=arguments.length;n>e;e++)t.appendChild(arguments[e]);return t}function n(t,e,n,o){var i=["opacity",e,~~(100*t),n,o].join("-"),s=.01+n/o*100,r=Math.max(1-(1-t)/e*(100-s),t),a=c.substring(0,c.indexOf("Animation")).toLowerCase(),l=a&&"-"+a+"-"||"";return u[i]||(h.insertRule("@"+l+"keyframes "+i+"{0%{opacity:"+r+"}"+s+"%{opacity:"+t+"}"+(s+.01)+"%{opacity:1}"+(s+e)%100+"%{opacity:"+t+"}100%{opacity:"+r+"}}",h.cssRules.length),u[i]=1),i}function o(t,e){var n,o,i=t.style;for(e=e.charAt(0).toUpperCase()+e.slice(1),o=0;o<d.length;o++)if(n=d[o]+e,void 0!==i[n])return n;return void 0!==i[e]?e:void 0}function i(t,e){for(var n in e)t.style[o(t,n)||n]=e[n];return t}function s(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)void 0===t[o]&&(t[o]=n[o])}return t}function r(t,e){return"string"==typeof t?t:t[e%t.length]}function a(t){this.opts=s(t||{},a.defaults,f)}function l(){function n(e,n){return t("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',n)}h.addRule(".spin-vml","behavior:url(#default#VML)"),a.prototype.lines=function(t,o){function s(){return i(n("group",{coordsize:d+" "+d,coordorigin:-c+" "+-c}),{width:d,height:d})}function a(t,a,l){e(h,e(i(s(),{rotation:360/o.lines*t+"deg",left:~~a}),e(i(n("roundrect",{arcsize:o.corners}),{width:c,height:o.width,left:o.radius,top:-o.width>>1,filter:l}),n("fill",{color:r(o.color,t),opacity:o.opacity}),n("stroke",{opacity:0}))))}var l,c=o.length+o.width,d=2*c,u=2*-(o.width+o.length)+"px",h=i(s(),{position:"absolute",top:u,left:u});if(o.shadow)for(l=1;l<=o.lines;l++)a(l,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(l=1;l<=o.lines;l++)a(l);return e(t,h)},a.prototype.opacity=function(t,e,n,o){var i=t.firstChild;o=o.shadow&&o.lines||0,i&&e+o<i.childNodes.length&&(i=i.childNodes[e+o],i=i&&i.firstChild,i=i&&i.firstChild,i&&(i.opacity=n))}}var c,d=["webkit","Moz","ms","O"],u={},h=function(){var n=t("style",{type:"text/css"});return e(document.getElementsByTagName("head")[0],n),n.sheet||n.styleSheet}(),f={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",position:"absolute"};a.defaults={},s(a.prototype,{spin:function(e){this.stop();{var n=this,o=n.opts,s=n.el=i(t(0,{className:o.className}),{position:o.position,width:0,zIndex:o.zIndex});o.radius+o.length+o.width}if(i(s,{left:o.left,top:o.top}),e&&e.insertBefore(s,e.firstChild||null),s.setAttribute("role","progressbar"),n.lines(s,n.opts),!c){var r,a=0,l=(o.lines-1)*(1-o.direction)/2,d=o.fps,u=d/o.speed,h=(1-o.opacity)/(u*o.trail/100),f=u/o.lines;!function p(){a++;for(var t=0;t<o.lines;t++)r=Math.max(1-(a+(o.lines-t)*f)%u*h,o.opacity),n.opacity(s,t*o.direction+l,r,o);n.timeout=n.el&&setTimeout(p,~~(1e3/d))}()}return n},stop:function(){var t=this.el;return t&&(clearTimeout(this.timeout),t.parentNode&&t.parentNode.removeChild(t),this.el=void 0),this},lines:function(o,s){function a(e,n){return i(t(),{position:"absolute",width:s.length+s.width+"px",height:s.width+"px",background:e,boxShadow:n,transformOrigin:"left",transform:"rotate("+~~(360/s.lines*d+s.rotate)+"deg) translate("+s.radius+"px,0)",borderRadius:(s.corners*s.width>>1)+"px"})}for(var l,d=0,u=(s.lines-1)*(1-s.direction)/2;d<s.lines;d++)l=i(t(),{position:"absolute",top:1+~(s.width/2)+"px",transform:s.hwaccel?"translate3d(0,0,0)":"",opacity:s.opacity,animation:c&&n(s.opacity,s.trail,u+d*s.direction,s.lines)+" "+1/s.speed+"s linear infinite"}),s.shadow&&e(l,i(a("#000","0 0 4px #000"),{top:"2px"})),e(o,e(l,a(r(s.color,d),"0 0 1px rgba(0,0,0,.1)")));return o},opacity:function(t,e,n){e<t.childNodes.length&&(t.childNodes[e].style.opacity=n)}});var p=i(t("group"),{behavior:"url(#default#VML)"});return!o(p,"transform")&&p.adj?l():c=o(p,"animation"),a})},{}],55:[function(t,e){"use strict";var n=t("./lodash"),o=t("./blocks"),i=function(t){this.type=t,this.block_type=o[this.type].prototype,this.can_be_rendered=this.block_type.toolbarEnabled,this._ensureElement()};Object.assign(i.prototype,t("./function-bind"),t("./renderable"),t("./events"),{tagName:"a",className:"st-block-control",attributes:function(){return{"data-type":this.block_type.type}},render:function(){return this.$el.html('<span class="st-icon">'+n.result(this.block_type,"icon_name")+"</span>"+n.result(this.block_type,"title")),this}}),e.exports=i},{"./blocks":73,"./events":83,"./function-bind":92,"./lodash":97,"./renderable":99}],56:[function(t,e){(function(n){"use strict";var o=t("./lodash"),i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,s=t("./blocks"),r=t("./block-control"),a=t("./event-bus"),l=function(t,e){this.available_types=t||[],this.mediator=e,this._ensureElement(),this._bindFunctions(),this._bindMediatedEvents(),this.initialize()};Object.assign(l.prototype,t("./function-bind"),t("./mediated-events"),t("./renderable"),t("./events"),{bound:["handleControlButtonClick"],block_controls:null,className:"st-block-controls",eventNamespace:"block-controls",mediatedEvents:{render:"renderInContainer",show:"show",hide:"hide"},initialize:function(){for(var t in this.available_types)if(s.hasOwnProperty(t)){var e=new r(t);e.can_be_rendered&&this.$el.append(e.render().$el)}this.$el.delegate(".st-block-control","click",this.handleControlButtonClick),this.mediator.on("block-controls:show",this.renderInContainer)},show:function(){this.$el.addClass("st-block-controls--active"),a.trigger("block:controls:shown")},hide:function(){this.removeCurrentContainer(),this.$el.removeClass("st-block-controls--active"),a.trigger("block:controls:hidden")},handleControlButtonClick:function(t){t.stopPropagation(),this.mediator.trigger("block:create",i(t.currentTarget).attr("data-type"))},renderInContainer:function(t){this.removeCurrentContainer(),t.append(this.$el.detach()),t.addClass("with-st-controls"),this.currentContainer=t,this.show()},removeCurrentContainer:function(){o.isUndefined(this.currentContainer)||(this.currentContainer.removeClass("with-st-controls"),this.currentContainer=void 0)}}),e.exports=l}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./block-control":55,"./blocks":73,"./event-bus":82,"./events":83,"./function-bind":92,"./lodash":97,"./mediated-events":98,"./renderable":99}],57:[function(t,e){"use strict";var n=function(){this._ensureElement(),this._bindFunctions()};Object.assign(n.prototype,t("./function-bind"),t("./renderable"),{tagName:"a",className:"st-block-ui-btn st-block-ui-btn--delete st-icon",attributes:{html:"delete","data-icon":"bin"}}),e.exports=n},{"./function-bind":92,"./renderable":99}],58:[function(t,e){"use strict";var n=t("./lodash"),o=t("./utils"),i=t("./config"),s=t("./event-bus"),r=t("./blocks"),a=function(t,e,n){this.options=t,this.instance_scope=e,this.mediator=n,this.blocks=[],this.blockCounts={},this.blockTypes={},this._setBlocksTypes(),this._setRequired(),this._bindMediatedEvents(),this.initialize()};Object.assign(a.prototype,t("./function-bind"),t("./mediated-events"),t("./events"),{eventNamespace:"block",mediatedEvents:{create:"createBlock",remove:"removeBlock",rerender:"rerenderBlock"},initialize:function(){},createBlock:function(t,e){if(t=o.classify(t),this.canCreateBlock(t)){var n=new r[t](e,this.instance_scope,this.mediator);this.blocks.push(n),this._incrementBlockTypeCount(t),this.mediator.trigger("block:render",n),this.triggerBlockCountUpdate(),this.mediator.trigger("block:limitReached",this.blockLimitReached()),o.log("Block created of type "+t)}},removeBlock:function(t){var e=this.findBlockById(t),n=o.classify(e.type);this.mediator.trigger("block-controls:reset"),this.blocks=this.blocks.filter(function(t){return t.blockID!==e.blockID}),this._decrementBlockTypeCount(n),this.triggerBlockCountUpdate(),this.mediator.trigger("block:limitReached",this.blockLimitReached()),s.trigger("block:remove")},rerenderBlock:function(t){var e=this.findBlockById(t);n.isUndefined(e)||e.isEmpty()||!e.drop_options.re_render_on_reorder||e.beforeLoadingData()},triggerBlockCountUpdate:function(){this.mediator.trigger("block:countUpdate",this.blocks.length)},canCreateBlock:function(t){return this.blockLimitReached()?(o.log("Cannot add any more blocks. Limit reached."),!1):this.isBlockTypeAvailable(t)?this.canAddBlockType(t)?!0:(o.log("Block Limit reached for type "+t),!1):(o.log("Block type not available "+t),!1)},validateBlockTypesExist:function(t){return i.skipValidation||!t?!1:void(this.required||[]).forEach(function(t){if(this.isBlockTypeAvailable(t))if(0===this._getBlockTypeCount(t))o.log("Failed validation on required block type "+t),this.mediator.trigger("errors:add",{text:i18n.t("errors:type_missing",{type:t})});else{var e=this.getBlocksByType(t).filter(function(t){return!t.isEmpty()});if(e.length>0)return!1;this.mediator.trigger("errors:add",{text:i18n.t("errors:required_type_empty",{type:t})}),o.log("A required block type "+t+" is empty")}},this)},findBlockById:function(t){return this.blocks.find(function(e){return e.blockID===t})},getBlocksByType:function(t){return this.blocks.filter(function(e){return o.classify(e.type)===t})},getBlocksByIDs:function(t){return this.blocks.filter(function(e){return t.includes(e.blockID)})},blockLimitReached:function(){return 0!==this.options.blockLimit&&this.blocks.length>=this.options.blockLimit},isBlockTypeAvailable:function(t){return!n.isUndefined(this.blockTypes[t])},canAddBlockType:function(t){var e=this._getBlockTypeLimit(t);return!(0!==e&&this._getBlockTypeCount(t)>=e)},_setBlocksTypes:function(){this.blockTypes=o.flatten(n.isUndefined(this.options.blockTypes)?r:this.options.blockTypes)},_setRequired:function(){this.required=!1,Array.isArray(this.options.required)&&!n.isEmpty(this.options.required)&&(this.required=this.options.required)},_incrementBlockTypeCount:function(t){this.blockCounts[t]=n.isUndefined(this.blockCounts[t])?1:this.blockCounts[t]+1},_decrementBlockTypeCount:function(t){this.blockCounts[t]=n.isUndefined(this.blockCounts[t])?1:this.blockCounts[t]-1},_getBlockTypeCount:function(t){return n.isUndefined(this.blockCounts[t])?0:this.blockCounts[t]},_blockLimitReached:function(){return 0!==this.options.blockLimit&&this.blocks.length>=this.options.blockLimit},_getBlockTypeLimit:function(t){return this.isBlockTypeAvailable(t)?parseInt(n.isUndefined(this.options.blockTypeLimits[t])?0:this.options.blockTypeLimits[t],10):0}}),e.exports=a},{"./blocks":73,"./config":79,"./event-bus":82,"./events":83,"./function-bind":92,"./lodash":97,"./mediated-events":98,"./utils":103}],59:[function(t,e){"use strict";var n=["<div class='st-block-positioner__inner'>","<span class='st-block-positioner__selected-value'></span>","<select class='st-block-positioner__select'></select>","</div>"].join("\n"),o=function(t,e){this.mediator=e,this.$block=t,this._ensureElement(),this._bindFunctions(),this.initialize()};Object.assign(o.prototype,t("./function-bind"),t("./renderable"),{total_blocks:0,bound:["onBlockCountChange","onSelectChange","toggle","show","hide"],className:"st-block-positioner",visibleClass:"st-block-positioner--is-visible",initialize:function(){this.$el.append(n),this.$select=this.$(".st-block-positioner__select"),this.$select.on("change",this.onSelectChange),this.mediator.on("block:countUpdate",this.onBlockCountChange)},onBlockCountChange:function(t){t!==this.total_blocks&&(this.total_blocks=t,this.renderPositionList())},onSelectChange:function(){var t=this.$select.val();0!==t&&(this.mediator.trigger("block:changePosition",this.$block,t,1===t?"before":"after"),this.toggle())},renderPositionList:function(){for(var t="<option value='0'>"+i18n.t("general:position")+"</option>",e=1;e<=this.total_blocks;e++)t+="<option value="+e+">"+e+"</option>";this.$select.html(t)},toggle:function(){this.$select.val(0),this.$el.toggleClass(this.visibleClass)},show:function(){this.$el.addClass(this.visibleClass)},hide:function(){this.$el.removeClass(this.visibleClass)}}),e.exports=o},{"./function-bind":92,"./renderable":99}],60:[function(t,e){(function(n){"use strict";var o=t("./lodash"),i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,s=t("./event-bus"),r=function(t,e){this.$block=t,this.blockID=this.$block.attr("id"),this.mediator=e,this._ensureElement(),this._bindFunctions(),this.initialize()};Object.assign(r.prototype,t("./function-bind"),t("./renderable"),{bound:["onMouseDown","onDragStart","onDragEnd","onDrop"],className:"st-block-ui-btn st-block-ui-btn--reorder st-icon",tagName:"a",attributes:function(){return{html:"reorder",draggable:"true","data-icon":"move"}},initialize:function(){this.$el.bind("mousedown touchstart",this.onMouseDown).bind("dragstart",this.onDragStart).bind("dragend touchend",this.onDragEnd),this.$block.dropArea().bind("drop",this.onDrop)},blockId:function(){return this.$block.attr("id")},onMouseDown:function(){this.mediator.trigger("block-controls:hide"),s.trigger("block:reorder:down")},onDrop:function(t){t.preventDefault();var e=this.$block,n=t.originalEvent.dataTransfer.getData("text/plain"),r=i("#"+n);o.isUndefined(n)||o.isEmpty(r)||e.attr("id")===n||e.attr("data-instance")!==r.attr("data-instance")||e.after(r),this.mediator.trigger("block:rerender",n),s.trigger("block:reorder:dropped",n)},onDragStart:function(t){var e=i(t.currentTarget).parent();t.originalEvent.dataTransfer.setDragImage(this.$block[0],e.position().left,e.position().top),t.originalEvent.dataTransfer.setData("Text",this.blockId()),s.trigger("block:reorder:dragstart"),this.$block.addClass("st-block--dragging")
},onDragEnd:function(){s.trigger("block:reorder:dragend"),this.$block.removeClass("st-block--dragging")},render:function(){return this}}),e.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./event-bus":82,"./function-bind":92,"./lodash":97,"./renderable":99}],61:[function(t,e){"use strict";var n=t("./lodash"),o=t("./utils"),i=t("./event-bus");e.exports={blockStorage:{},createStore:function(t){this.blockStorage={type:o.underscored(this.type),data:t||{}}},save:function(){var t=this._serializeData();n.isEmpty(t)||this.setData(t)},getData:function(){return this.save(),this.blockStorage},getBlockData:function(){return this.save(),this.blockStorage.data},_getData:function(){return this.blockStorage.data},setData:function(t){o.log("Setting data for block "+this.blockID),Object.assign(this.blockStorage.data,t||{})},setAndLoadData:function(t){this.setData(t),this.beforeLoadingData()},_serializeData:function(){},loadData:function(){},beforeLoadingData:function(){o.log("loadData for "+this.blockID),i.trigger("editor/block/loadData"),this.loadData(this._getData())},_loadData:function(){o.log("_loadData is deprecated and will be removed in the future. Please use beforeLoadingData instead."),this.beforeLoadingData()},checkAndLoadData:function(){n.isEmpty(this._getData())||this.beforeLoadingData()}}},{"./event-bus":82,"./lodash":97,"./utils":103}],62:[function(t,e){(function(n){"use strict";var o=t("./lodash"),i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,s=t("./utils"),r=function(t){var e=t.attr("data-st-name")||t.attr("name");return e||(e="Field"),s.capitalize(e)};e.exports={errors:[],valid:function(){return this.performValidations(),0===this.errors.length},performValidations:function(){this.resetErrors();var t=this.$(".st-required");t.each(function(t,e){this.validateField(e)}.bind(this)),this.validations.forEach(this.runValidator,this),this.$el.toggleClass("st-block--with-errors",this.errors.length>0)},validations:[],validateField:function(t){t=i(t);var e=t.attr("contenteditable")?t.text():t.val();0===e.length&&this.setError(t,i18n.t("errors:block_empty",{name:r(t)}))},runValidator:function(t){o.isUndefined(this[t])||this[t].call(this)},setError:function(t,e){var n=this.addMessage(e,"st-msg--error");t.addClass("st-error"),this.errors.push({field:t,reason:e,msg:n})},resetErrors:function(){this.errors.forEach(function(t){t.field.removeClass("st-error"),t.msg.remove()}),this.$messages.removeClass("st-block__messages--is-visible"),this.errors=[]}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./lodash":97,"./utils":103}],63:[function(t,e){(function(n){"use strict";var o=t("./lodash"),i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,s=t("./config"),r=t("./utils"),a=t("./to-html"),l=t("./to-markdown"),c=t("./block_mixins"),d=t("./simple-block"),u=t("./block-reorder"),h=t("./block-deletion"),f=t("./block-positioner"),p=t("./formatters"),b=t("./event-bus"),m=t("spin.js"),g=function(){d.apply(this,arguments)};g.prototype=Object.create(d.prototype),g.prototype.constructor=g;var v=["<div class='st-block__ui-delete-controls'>","<label class='st-block__delete-label'>","<%= i18n.t('general:delete') %>","</label>","<a class='st-block-ui-btn st-block-ui-btn--confirm-delete st-icon' data-icon='tick'></a>","<a class='st-block-ui-btn st-block-ui-btn--deny-delete st-icon' data-icon='close'></a>","</div>"].join("\n"),k={html:['<div class="st-block__dropzone">','<span class="st-icon"><%= _.result(block, "icon_name") %></span>','<p><%= i18n.t("general:drop", { block: "<span>" + _.result(block, "title") + "</span>" }) %>',"</p></div>"].join("\n"),re_render_on_reorder:!1},_={html:['<input type="text" placeholder="<%= i18n.t("general:paste") %>"',' class="st-block__paste-input st-paste-block">'].join("")},y={html:['<div class="st-block__upload-container">','<input type="file" type="st-file-upload">','<button class="st-upload-btn"><%= i18n.t("general:upload") %></button>',"</div>"].join("\n")};s.defaults.Block={drop_options:k,paste_options:_,upload_options:y},Object.assign(g.prototype,d.fn,t("./block-validations"),{bound:["_handleContentPaste","_onFocus","_onBlur","onDrop","onDeleteClick","clearInsertedStyles","getSelectionForFormatter","onBlockRender"],className:"st-block st-icon--add",attributes:function(){return Object.assign(d.fn.attributes.call(this),{"data-icon-after":"add"})},icon_name:"default",validationFailMsg:function(){return i18n.t("errors:validation_fail",{type:this.title()})},editorHTML:'<div class="st-block__editor"></div>',toolbarEnabled:!0,availableMixins:["droppable","pastable","uploadable","fetchable","ajaxable","controllable"],droppable:!1,pastable:!1,uploadable:!1,fetchable:!1,ajaxable:!1,drop_options:{},paste_options:{},upload_options:{},formattable:!0,_previousSelection:"",initialize:function(){},toMarkdown:function(t){return t},toHTML:function(t){return t},withMixin:function(t){if(o.isObject(t)){var e="initialize"+t.mixinName;o.isUndefined(this[e])&&(Object.assign(this,t),this[e]())}},render:function(){if(this.beforeBlockRender(),this._setBlockInner(),this.$editor=this.$inner.children().first(),this.droppable||this.pastable||this.uploadable){var t=i("<div>",{"class":"st-block__inputs"});this.$inner.append(t),this.$inputs=t}return this.hasTextBlock&&this._initTextBlocks(),this.availableMixins.forEach(function(t){this[t]&&this.withMixin(c[r.classify(t)])},this),this.formattable&&this._initFormatting(),this._blockPrepare(),this},remove:function(){this.ajaxable&&this.resolveAllInQueue(),this.$el.remove()},loading:function(){o.isUndefined(this.spinner)||this.ready(),this.spinner=new m(s.defaults.spinner),this.spinner.spin(this.$el[0]),this.$el.addClass("st--is-loading")},ready:function(){this.$el.removeClass("st--is-loading"),o.isUndefined(this.spinner)||(this.spinner.stop(),delete this.spinner)},_serializeData:function(){r.log("toData for "+this.blockID);var t={};if(this.hasTextBlock()){var e=this.getTextBlock().html();e.length>0&&(t.text=l(e,this.type))}return this.$(":input").not(".st-paste-block").length>0&&this.$(":input").each(function(e,n){n.getAttribute("name")&&(t[n.getAttribute("name")]=n.value)}),t},focus:function(){this.getTextBlock().focus()},blur:function(){this.getTextBlock().blur()},onFocus:function(){this.getTextBlock().bind("focus",this._onFocus)},onBlur:function(){this.getTextBlock().bind("blur",this._onBlur)},_onFocus:function(){this.trigger("blockFocus",this.$el)},_onBlur:function(){},onBlockRender:function(){this.focus()},onDrop:function(){},onDeleteClick:function(t){t.preventDefault();var e=function(t){t.preventDefault(),this.mediator.trigger("block:remove",this.blockID),this.remove()},n=function(t){t.preventDefault(),this.$el.removeClass("st-block--delete-active"),i.remove()};if(this.isEmpty())return void e.call(this,new Event("click"));this.$inner.append(o.template(v)),this.$el.addClass("st-block--delete-active");var i=this.$inner.find(".st-block__ui-delete-controls");this.$inner.on("click",".st-block-ui-btn--confirm-delete",e.bind(this)).on("click",".st-block-ui-btn--deny-delete",n.bind(this))},pastedMarkdownToHTML:function(t){return a(l(t,this.type),this.type)},onContentPasted:function(t,e){e.html(this.pastedMarkdownToHTML(e[0].innerHTML)),this.getTextBlock().caretToEnd()},beforeLoadingData:function(){this.loading(),(this.droppable||this.uploadable||this.pastable)&&(this.$editor.show(),this.$inputs.hide()),d.fn.beforeLoadingData.call(this),this.ready()},_handleContentPaste:function(t){setTimeout(this.onContentPasted.bind(this,t,i(t.currentTarget)),0)},_getBlockClass:function(){return"st-block--"+this.className},_initUIComponents:function(){var t=new f(this.$el,this.mediator);this._withUIComponent(t,".st-block-ui-btn--reorder",t.toggle),this._withUIComponent(new u(this.$el,this.mediator)),this._withUIComponent(new h,".st-block-ui-btn--delete",this.onDeleteClick),this.onFocus(),this.onBlur()},_initFormatting:function(){var t;for(var e in p)p.hasOwnProperty(e)&&(t=p[e],o.isUndefined(t.keyCode)||t._bindToBlock(this.$el))},_initTextBlocks:function(){this.getTextBlock().bind("paste",this._handleContentPaste).bind("keyup",this.getSelectionForFormatter).bind("mouseup",this.getSelectionForFormatter).bind("DOMNodeInserted",this.clearInsertedStyles)},getSelectionForFormatter:function(){var t=this;setTimeout(function(){var e=window.getSelection(),n=e.toString().trim(),o="formatter:"+(""===n?"hide":"position");t.mediator.trigger(o,t),b.trigger(o,t)},1)},clearInsertedStyles:function(t){var e=t.target;e.removeAttribute("style")},hasTextBlock:function(){return this.getTextBlock().length>0},getTextBlock:function(){return o.isUndefined(this.text_block)&&(this.text_block=this.$(".st-text-block")),this.text_block},isEmpty:function(){return o.isEmpty(this.getBlockData())}}),g.extend=t("./helpers/extend"),e.exports=g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./block-deletion":57,"./block-positioner":59,"./block-reorder":60,"./block-validations":62,"./block_mixins":68,"./config":79,"./event-bus":82,"./formatters":91,"./helpers/extend":94,"./lodash":97,"./simple-block":100,"./to-html":101,"./to-markdown":102,"./utils":103,"spin.js":54}],64:[function(t,e){"use strict";var n=t("../utils");e.exports={mixinName:"Ajaxable",ajaxable:!0,initializeAjaxable:function(){this._queued=[]},addQueuedItem:function(t,e){n.log("Adding queued item for "+this.blockID+" called "+t),this._queued.push({name:t,deferred:e})},removeQueuedItem:function(t){n.log("Removing queued item for "+this.blockID+" called "+t),this._queued=this._queued.filter(function(e){return e.name!==t})},hasItemsInQueue:function(){return this._queued.length>0},resolveAllInQueue:function(){this._queued.forEach(function(t){n.log("Aborting queued request: "+t.name),t.deferred.abort()},this)}}},{"../utils":103}],65:[function(t,e){(function(n){"use strict";var o="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,i=t("../utils");e.exports={mixinName:"Controllable",initializeControllable:function(){i.log("Adding controllable to block "+this.blockID),this.$control_ui=o("<div>",{"class":"st-block__control-ui"}),Object.keys(this.controls).forEach(function(t){this.addUiControl(t,this.controls[t].bind(this))},this),this.$inner.append(this.$control_ui)},getControlTemplate:function(t){return o("<a>",{"data-icon":t,"class":"st-icon st-block-control-ui-btn st-block-control-ui-btn--"+t})},addUiControl:function(t,e){this.$control_ui.append(this.getControlTemplate(t)),this.$control_ui.on("click",".st-block-control-ui-btn--"+t,e)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../utils":103}],66:[function(t,e){(function(n){"use strict";var o=t("../lodash"),i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,s=t("../config"),r=t("../utils"),a=t("../event-bus");e.exports={mixinName:"Droppable",valid_drop_file_types:["File","Files","text/plain","text/uri-list"],initializeDroppable:function(){r.log("Adding droppable to block "+this.blockID),this.drop_options=Object.assign({},s.defaults.Block.drop_options,this.drop_options);var t=i(o.template(this.drop_options.html,{block:this,_:o}));this.$editor.hide(),this.$inputs.append(t),this.$dropzone=t,this.$dropzone.dropArea().bind("drop",this._handleDrop.bind(this)),this.$inner.addClass("st-block__inner--droppable")},_handleDrop:function(t){t.preventDefault(),t=t.originalEvent;var e=i(t.target),n=t.dataTransfer.types;e.removeClass("st-dropzone--dragover"),n&&n.some(function(t){return this.valid_drop_file_types.includes(t)},this)&&this.onDrop(t.dataTransfer),a.trigger("block:content:dropped",this.blockID)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../config":79,"../event-bus":82,"../lodash":97,"../utils":103}],67:[function(t,e){(function(n){"use strict";var o=t("../lodash"),i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null;e.exports={mixinName:"Fetchable",initializeFetchable:function(){this.withMixin(t("./ajaxable"))},fetch:function(t,e,n){var s=o.uniqueId(this.blockID+"_fetch"),r=i.ajax(t);return this.resetMessages(),this.addQueuedItem(s,r),o.isUndefined(e)||r.done(e.bind(this)),o.isUndefined(n)||r.fail(n.bind(this)),r.always(this.removeQueuedItem.bind(this,s)),r}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../lodash":97,"./ajaxable":64}],68:[function(t,e){"use strict";e.exports={Ajaxable:t("./ajaxable.js"),Controllable:t("./controllable.js"),Droppable:t("./droppable.js"),Fetchable:t("./fetchable.js"),Pastable:t("./pastable.js"),Uploadable:t("./uploadable.js")}},{"./ajaxable.js":64,"./controllable.js":65,"./droppable.js":66,"./fetchable.js":67,"./pastable.js":69,"./uploadable.js":70}],69:[function(t,e){(function(n){"use strict";var o=t("../lodash"),i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,s=t("../config"),r=t("../utils");e.exports={mixinName:"Pastable",initializePastable:function(){r.log("Adding pastable to block "+this.blockID),this.paste_options=Object.assign({},s.defaults.Block.paste_options,this.paste_options),this.$inputs.append(o.template(this.paste_options.html,this)),this.$(".st-paste-block").bind("click",function(){i(this).select()}).bind("paste",this._handleContentPaste).bind("submit",this._handleContentPaste)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../config":79,"../lodash":97,"../utils":103}],70:[function(t,e){"use strict";var n=t("../lodash"),o=t("../config"),i=t("../utils"),s=t("../extensions/file-uploader");e.exports={mixinName:"Uploadable",uploadsCount:0,initializeUploadable:function(){i.log("Adding uploadable to block "+this.blockID),this.withMixin(t("./ajaxable")),this.upload_options=Object.assign({},o.defaults.Block.upload_options,this.upload_options),this.$inputs.append(n.template(this.upload_options.html,this))},uploader:function(t,e,n){return s(this,t,e,n)}}},{"../config":79,"../extensions/file-uploader":85,"../lodash":97,"../utils":103,"./ajaxable":64}],71:[function(t,e){"use strict";var n=t("../block"),o=t("../to-html");e.exports=n.extend({type:"Heading",title:function(){return i18n.t("blocks:heading:title")},editorHTML:'<div class="st-required st-text-block st-text-block--heading" contenteditable="true"></div>',icon_name:"heading",loadData:function(t){this.getTextBlock().html(o(t.text,this.type))}})},{"../block":63,"../to-html":101}],72:[function(t,e){(function(n){"use strict";var o="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,i=t("../block");e.exports=i.extend({type:"image",title:function(){return i18n.t("blocks:image:title")},droppable:!0,uploadable:!0,icon_name:"image",loadData:function(t){this.$editor.html(o("<img>",{src:t.file.url}))},onBlockRender:function(){this.$inputs.find("button").bind("click",function(t){t.preventDefault()}),this.$inputs.find("input").on("change",function(t){this.onDrop(t.currentTarget)}.bind(this))},onDrop:function(t){var e=t.files[0],n="undefined"!=typeof URL?URL:"undefined"!=typeof webkitURL?webkitURL:null;/image/.test(e.type)&&(this.loading(),this.$inputs.hide(),this.$editor.html(o("<img>",{src:n.createObjectURL(e)})).show(),this.uploader(e,function(t){this.setData(t),this.ready()},function(){this.addMessage(i18n.t("blocks:image:upload_error")),this.ready()}))}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../block":63}],73:[function(t,e){"use strict";e.exports={Text:t("./text"),Quote:t("./quote"),Image:t("./image"),Heading:t("./heading"),List:t("./list"),Tweet:t("./tweet"),Video:t("./video")}},{"./heading":71,"./image":72,"./list":74,"./quote":75,"./text":76,"./tweet":77,"./video":78}],74:[function(t,e){"use strict";var n=t("../lodash"),o=t("../block"),i=t("../to-html"),s='<div class="st-text-block st-required" contenteditable="true"><ul><li></li></ul></div>';e.exports=o.extend({type:"list",title:function(){return i18n.t("blocks:list:title")},icon_name:"list",editorHTML:function(){return n.template(s,this)},loadData:function(t){this.getTextBlock().html("<ul>"+i(t.text,this.type)+"</ul>")},onBlockRender:function(){this.checkForList=this.checkForList.bind(this),this.getTextBlock().on("click keyup",this.checkForList),this.focus()},checkForList:function(){0===this.$("ul").length&&document.execCommand("insertUnorderedList",!1,!1)},toMarkdown:function(t){return t.replace(/<\/li>/gm,"\n").replace(/<\/?[^>]+(>|$)/g,"").replace(/^(.+)$/gm," - $1")},toHTML:function(t){return t=t.replace(/^ - (.+)$/gm,"<li>$1</li>").replace(/\n/gm,"")},onContentPasted:function(t,e){this.$("ul").html(this.pastedMarkdownToHTML(e[0].innerHTML)),this.getTextBlock().caretToEnd()},isEmpty:function(){return n.isEmpty(this.getBlockData().text)}})},{"../block":63,"../lodash":97,"../to-html":101}],75:[function(t,e){"use strict";var n=t("../lodash"),o=t("../block"),i=t("../to-html"),s=n.template(['<blockquote class="st-required st-text-block" contenteditable="true"></blockquote>','<label class="st-input-label"> <%= i18n.t("blocks:quote:credit_field") %></label>','<input maxlength="140" name="cite" placeholder="<%= i18n.t("blocks:quote:credit_field") %>"',' class="st-input-string st-required js-cite-input" type="text" />'].join("\n"));e.exports=o.extend({type:"quote",title:function(){return i18n.t("blocks:quote:title")},icon_name:"quote",editorHTML:function(){return s(this)},loadData:function(t){this.getTextBlock().html(i(t.text,this.type)),this.$(".js-cite-input").val(t.cite)},toMarkdown:function(t){return t.replace(/^(.+)$/gm,"> $1")}})},{"../block":63,"../lodash":97,"../to-html":101}],76:[function(t,e){"use strict";var n=t("../block"),o=t("../to-html");e.exports=n.extend({type:"text",title:function(){return i18n.t("blocks:text:title")},editorHTML:'<div class="st-required st-text-block" contenteditable="true"></div>',icon_name:"text",loadData:function(t){this.getTextBlock().html(o(t.text,this.type))}})},{"../block":63,"../to-html":101}],77:[function(t,e){(function(n){"use strict";var o=t("../lodash"),i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,s=t("../utils"),r=t("../block"),a=o.template(["<blockquote class='twitter-tweet' align='center'>","<p><%= text %></p>","&mdash; <%= user.name %> (@<%= user.screen_name %>)","<a href='<%= status_url %>' data-datetime='<%= created_at %>'><%= created_at %></a>","</blockquote>",'<script src="//platform.twitter.com/widgets.js" charset="utf-8"></script>'].join("\n"));e.exports=r.extend({type:"tweet",droppable:!0,pastable:!0,fetchable:!0,drop_options:{re_render_on_reorder:!0},title:function(){return i18n.t("blocks:tweet:title")},fetchUrl:function(t){return"/tweets/?tweet_id="+t},icon_name:"twitter",loadData:function(t){o.isUndefined(t.status_url)&&(t.status_url=""),this.$inner.find("iframe").remove(),this.$inner.prepend(a(t))},onContentPasted:function(t){var e=i(t.target),n=e.val();this.handleTwitterDropPaste(n)},handleTwitterDropPaste:function(t){if(!this.validTweetUrl(t))return void s.log("Invalid Tweet URL");var e=t.match(/[^\/]+$/);if(!o.isEmpty(e)){this.loading(),e=e[0];var n={url:this.fetchUrl(e),dataType:"json"};this.fetch(n,this.onTweetSuccess,this.onTweetFail)}},validTweetUrl:function(t){return s.isURI(t)&&-1!==t.indexOf("twitter")&&-1!==t.indexOf("status")},onTweetSuccess:function(t){var e={user:{profile_image_url:t.user.profile_image_url,profile_image_url_https:t.user.profile_image_url_https,screen_name:t.user.screen_name,name:t.user.name},id:t.id_str,text:t.text,created_at:t.created_at,entities:t.entities,status_url:"https://twitter.com/"+t.user.screen_name+"/status/"+t.id_str};this.setAndLoadData(e),this.ready()},onTweetFail:function(){this.addMessage(i18n.t("blocks:tweet:fetch_error")),this.ready()},onDrop:function(t){var e=t.getData("text/plain");this.handleTwitterDropPaste(e)}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../block":63,"../lodash":97,"../utils":103}],78:[function(t,e){"use strict";var n=t("../lodash"),o=t("../utils"),i=t("../block");e.exports=i.extend({providers:{vimeo:{regex:/(?:http[s]?:\/\/)?(?:www.)?vimeo.com\/(.+)/,html:'<iframe src="<%= protocol %>//player.vimeo.com/video/<%= remote_id %>?title=0&byline=0" width="580" height="320" frameborder="0"></iframe>'},youtube:{regex:/(?:http[s]?:\/\/)?(?:www.)?(?:(?:youtube.com\/watch\?(?:.*)(?:v=))|(?:youtu.be\/))([^&].+)/,html:'<iframe src="<%= protocol %>//www.youtube.com/embed/<%= remote_id %>" width="580" height="320" frameborder="0" allowfullscreen></iframe>'}},type:"video",title:function(){return i18n.t("blocks:video:title")},droppable:!0,pastable:!0,icon_name:"video",loadData:function(t){if(this.providers.hasOwnProperty(t.source)){var e=this.providers[t.source],o="file:"===window.location.protocol?"http:":window.location.protocol,i=e.square?"with-square-media":"with-sixteen-by-nine-media";this.$editor.addClass("st-block__editor--"+i).html(n.template(e.html,{protocol:o,remote_id:t.remote_id,width:this.$editor.width()}))}},onContentPasted:function(t){this.handleDropPaste(t.target.value)},matchVideoProvider:function(t,e,o){var i=t.regex.exec(o);return null==i||n.isUndefined(i[1])?{}:{source:e,remote_id:i[1]}},handleDropPaste:function(t){if(o.isURI(t))for(var e in this.providers)this.providers.hasOwnProperty(e)&&this.setAndLoadData(this.matchVideoProvider(this.providers[e],e,t))},onDrop:function(t){var e=t.getData("text/plain");this.handleDropPaste(e)}})},{"../block":63,"../lodash":97,"../utils":103}],79:[function(t,e){"use strict";e.exports={debug:!1,skipValidation:!1,version:"0.4.0",language:"en",instances:[],defaults:{defaultType:!1,spinner:{className:"st-spinner",lines:9,length:8,width:3,radius:6,color:"#000",speed:1.4,trail:57,shadow:!1,left:"50%",top:"50%"},blockLimit:0,blockTypeLimits:{},required:[],uploadUrl:"/attachments",baseImageUrl:"/sir-trevor-uploads/",errorsContainer:void 0}}},{}],80:[function(t,e){(function(n){"use strict";var o=t("./lodash"),i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,s=t("./config"),r=t("./utils"),a=t("./events"),l=t("./event-bus"),c=t("./form-events"),d=t("./block-controls"),u=t("./block-manager"),h=t("./floating-block-controls"),f=t("./format-bar"),p=t("./extensions/editor-store"),b=t("./error-handler"),m=function(t){this.initialize(t)};Object.assign(m.prototype,t("./function-bind"),t("./events"),{bound:["onFormSubmit","hideAllTheThings","changeBlockPosition","removeBlockDragOver","renderBlock","resetBlockControls","blockLimitReached"],events:{"block:reorder:dragend":"removeBlockDragOver","block:content:dropped":"removeBlockDragOver"},initialize:function(t){return r.log("Init SirTrevor.Editor"),this.options=Object.assign({},s.defaults,t||{}),this.ID=o.uniqueId("st-editor-"),this._ensureAndSetElements()?(!o.isUndefined(this.options.onEditorRender)&&o.isFunction(this.options.onEditorRender)&&(this.onEditorRender=this.options.onEditorRender),this.mediator=Object.assign({},a),this._bindFunctions(),s.instances.push(this),this.build(),void c.bindFormSubmit(this.$form)):!1},build:function(){this.$el.hide(),this.errorHandler=new b(this.$outer,this.mediator,this.options.errorsContainer),this.store=new p(this.$el.val(),this.mediator),this.block_manager=new u(this.options,this.ID,this.mediator),this.block_controls=new d(this.block_manager.blockTypes,this.mediator),this.fl_block_controls=new h(this.$wrapper,this.ID,this.mediator),this.formatBar=new f(this.options.formatBar,this.mediator),this.mediator.on("block:changePosition",this.changeBlockPosition),this.mediator.on("block-controls:reset",this.resetBlockControls),this.mediator.on("block:limitReached",this.blockLimitReached),this.mediator.on("block:render",this.renderBlock),this.dataStore="Please use store.retrieve();",this._setEvents(),this.$wrapper.prepend(this.fl_block_controls.render().$el),i(document.body).append(this.formatBar.render().$el),this.$outer.append(this.block_controls.render().$el),i(window).bind("click",this.hideAllTheThings),this.createBlocks(),this.$wrapper.addClass("st-ready"),o.isUndefined(this.onEditorRender)||this.onEditorRender()},createBlocks:function(){var t=this.store.retrieve();t.data.length>0?t.data.forEach(function(t){this.mediator.trigger("block:create",t.type,t.data)},this):this.options.defaultType!==!1&&this.mediator.trigger("block:create",this.options.defaultType,{})},destroy:function(){this.formatBar.destroy(),this.fl_block_controls.destroy(),this.block_controls.destroy(),this.blocks.forEach(function(){this.mediator.trigger("block:remove",this.block.blockID)},this),this.mediator.stopListening(),this.stopListening(),s.instances=s.instances.filter(function(t){return t.ID!==this.ID},this),this.store.reset(),this.$outer.replaceWith(this.$el.detach())},reinitialize:function(t){this.destroy(),this.initialize(t||this.options)},resetBlockControls:function(){this.block_controls.renderInContainer(this.$wrapper),this.block_controls.hide()},blockLimitReached:function(t){this.$wrapper.toggleClass("st--block-limit-reached",t)},_setEvents:function(){Object.keys(this.events).forEach(function(t){l.on(t,this[this.events[t]],this)},this)},hideAllTheThings:function(){this.block_controls.hide(),this.formatBar.hide()},store:function(t,e){return r.log("The store method has been removed, please call store[methodName]"),this.store[t].call(this,e||{})},renderBlock:function(t){this._renderInPosition(t.render().$el),this.hideAllTheThings(),this.scrollTo(t.$el),t.trigger("onRender")},scrollTo:function(t){i("html, body").animate({scrollTop:t.position().top},300,"linear")},removeBlockDragOver:function(){this.$outer.find(".st-drag-over").removeClass("st-drag-over")},changeBlockPosition:function(t,e){e-=1;var n=this.getBlockPosition(t),o=this.$wrapper.find(".st-block").eq(e),i=n>e?"Before":"After";o&&o.attr("id")!==t.attr("id")&&(this.hideAllTheThings(),t["insert"+i](o),this.scrollTo(t))},_renderInPosition:function(t){this.block_controls.currentContainer?this.block_controls.currentContainer.after(t):this.$wrapper.append(t)},validateAndSaveBlock:function(t,e){if((!s.skipValidation||e)&&!t.valid())return this.mediator.trigger("errors:add",{text:o.result(t,"validationFailMsg")}),void r.log("Block "+t.blockID+" failed validation");var n=t.getData();r.log("Adding data for block "+t.blockID+" to block store:",n),this.store.addData(n)},onFormSubmit:function(t){return t=t===!1?!1:!0,r.log("Handling form submission for Editor "+this.ID),this.mediator.trigger("errors:reset"),this.store.reset(),this.validateBlocks(t),this.block_manager.validateBlockTypesExist(t),this.mediator.trigger("errors:render"),this.$el.val(this.store.toString()),this.errorHandler.errors.length},validateBlocks:function(t){var e=this;this.$wrapper.find(".st-block").each(function(n,s){var r=e.block_manager.findBlockById(i(s).attr("id"));o.isUndefined(r)||e.validateAndSaveBlock(r,t)})},findBlockById:function(t){return this.block_manager.findBlockById(t)},getBlocksByType:function(t){return this.block_manager.getBlocksByType(t)},getBlocksByIDs:function(t){return this.block_manager.getBlocksByIDs(t)},getBlockPosition:function(t){return this.$wrapper.find(".st-block").index(t)},_ensureAndSetElements:function(){if(o.isUndefined(this.options.el)||o.isEmpty(this.options.el))return r.log("You must provide an el"),!1;this.$el=this.options.el,this.el=this.options.el[0],this.$form=this.$el.parents("form");var t=i("<div>").attr({id:this.ID,"class":"st-outer",dropzone:"copy link move"}),e=i("<div>").attr({"class":"st-blocks"});return this.$el.wrap(t).wrap(e),this.$outer=this.$form.find("#"+this.ID),this.$wrapper=this.$outer.find(".st-blocks"),!0}}),e.exports=m}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./block-controls":56,"./block-manager":58,"./config":79,"./error-handler":81,"./event-bus":82,"./events":83,"./extensions/editor-store":84,"./floating-block-controls":87,"./form-events":88,"./format-bar":89,"./function-bind":92,"./lodash":97,"./utils":103}],81:[function(t,e){(function(n){"use strict";var o=t("./lodash"),i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,s=function(t,e,n){this.$wrapper=t,this.mediator=e,this.$el=n,o.isUndefined(this.$el)&&(this._ensureElement(),this.$wrapper.prepend(this.$el)),this.$el.hide(),this._bindFunctions(),this._bindMediatedEvents(),this.initialize()};Object.assign(s.prototype,t("./function-bind"),t("./mediated-events"),t("./renderable"),{errors:[],className:"st-errors",eventNamespace:"errors",mediatedEvents:{reset:"reset",add:"addMessage",render:"render"},initialize:function(){var t=i("<ul>");this.$el.append("<p>"+i18n.t("errors:title")+"</p>").append(t),this.$list=t},render:function(){return 0===this.errors.length?!1:(this.errors.forEach(this.createErrorItem,this),void this.$el.show())},createErrorItem:function(t){var e=i("<li>",{"class":"st-errors__msg",html:t.text});this.$list.append(e)},addMessage:function(t){this.errors.push(t)},reset:function(){return 0===this.errors.length?!1:(this.errors=[],this.$list.html(""),void this.$el.hide())}}),e.exports=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./function-bind":92,"./lodash":97,"./mediated-events":98,"./renderable":99}],82:[function(t,e){"use strict";e.exports=Object.assign({},t("./events"))},{"./events":83}],83:[function(t,e){"use strict";e.exports=t("eventablejs")},{eventablejs:3}],84:[function(t,e){"use strict";var n=t("../lodash"),o=t("../utils"),i=function(t,e){this.mediator=e,this.initialize(t?t.trim():"")};Object.assign(i.prototype,{initialize:function(t){this.store=this._parseData(t)||{data:[]}},retrieve:function(){return this.store},toString:function(t){return JSON.stringify(this.store,void 0,t)},reset:function(){o.log("Resetting the EditorStore"),this.store={data:[]}},addData:function(t){return this.store.data.push(t),this.store},_parseData:function(t){var e;if(0===t.length)return e;try{var o=JSON.parse(t);n.isUndefined(o.data)||(e=o)}catch(i){this.mediator.trigger("errors:add",{text:i18n.t("errors:load_fail")}),this.mediator.trigger("errors:render"),console.log("Sorry there has been a problem with parsing the JSON"),console.log(i)}return e}}),e.exports=i},{"../lodash":97,"../utils":103}],85:[function(t,e){(function(n){"use strict";var o=t("../lodash"),i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,s=(t("../config"),t("../utils")),r=t("../event-bus");e.exports=function(t,e,n,a){var l,c,d;return r.trigger("onUploadStart"),d=[t.blockID,(new Date).getTime(),"raw"].join("-"),t.resetMessages(),c=function(){s.log("Upload callback called"),r.trigger("onUploadStop"),!o.isUndefined(n)&&o.isFunction(n)&&(t.setData({file:{url:this.url}}),n.apply(t,arguments))},l=function(e,n){return s.log("Upload callback error called"),r.trigger("onUploadStop"),!o.isUndefined(a)&&o.isFunction(a)?a.call(t,n):void 0},i.ajax({url:"/blog/sign_s3",data:{file_name:e.name,file_type:e.type},type:"GET",error:l,success:function(n){var o;return o=i.ajax({url:n.url,contentType:e.type,crossDomain:!0,data:e,processData:!1,headers:{"Content-MD5":e.md5,Authorization:n.signature,"x-amz-date":n.date,"x-amz-acl":"public-read"},type:"PUT",success:c}),t.addQueuedItem(d,o),o.done(c).fail(l).always(t.removeQueuedItem.bind(t,d)),o}})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../config":79,"../event-bus":82,"../lodash":97,"../utils":103}],86:[function(t,e){(function(n){"use strict";var o="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,i=t("../utils"),s=t("../event-bus"),r=function(t){this.$form=t,this.intialize()
};Object.assign(r.prototype,{intialize:function(){this.submitBtn=this.$form.find("input[type='submit']");var t=[];this.submitBtn.each(function(e,n){t.push(o(n).attr("value"))}),this.submitBtnTitles=t,this.canSubmit=!0,this.globalUploadCount=0,this._bindEvents()},setSubmitButton:function(t,e){this.submitBtn.attr("value",e)},resetSubmitButton:function(){var t=this.submitBtnTitles;this.submitBtn.each(function(e,n){o(n).attr("value",t[e])})},onUploadStart:function(){this.globalUploadCount++,i.log("onUploadStart called "+this.globalUploadCount),1===this.globalUploadCount&&this._disableSubmitButton()},onUploadStop:function(){this.globalUploadCount=this.globalUploadCount<=0?0:this.globalUploadCount-1,i.log("onUploadStop called "+this.globalUploadCount),0===this.globalUploadCount&&this._enableSubmitButton()},onError:function(){i.log("onError called"),this.canSubmit=!1},_disableSubmitButton:function(t){this.setSubmitButton(null,t||i18n.t("general:wait")),this.submitBtn.attr("disabled","disabled").addClass("disabled")},_enableSubmitButton:function(){this.resetSubmitButton(),this.submitBtn.removeAttr("disabled").removeClass("disabled")},_events:{disableSubmitButton:"_disableSubmitButton",enableSubmitButton:"_enableSubmitButton",setSubmitButton:"setSubmitButton",resetSubmitButton:"resetSubmitButton",onError:"onError",onUploadStart:"onUploadStart",onUploadStop:"onUploadStop"},_bindEvents:function(){Object.keys(this._events).forEach(function(t){s.on(t,this[this._events[t]],this)},this)}}),e.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../event-bus":82,"../utils":103}],87:[function(t,e){(function(n){"use strict";var o=t("./lodash"),i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,s=t("./event-bus"),r=function(t,e,n){this.$wrapper=t,this.instance_id=e,this.mediator=n,this._ensureElement(),this._bindFunctions(),this.initialize()};Object.assign(r.prototype,t("./function-bind"),t("./renderable"),t("./events"),{className:"st-block-controls__top",attributes:function(){return{"data-icon":"add"}},bound:["handleBlockMouseOut","handleBlockMouseOver","handleBlockClick","onDrop"],initialize:function(){this.$el.on("click",this.handleBlockClick).dropArea().bind("drop",this.onDrop),this.$wrapper.on("mouseover",".st-block",this.handleBlockMouseOver).on("mouseout",".st-block",this.handleBlockMouseOut).on("click",".st-block--with-plus",this.handleBlockClick)},onDrop:function(t){t.preventDefault();var e=this.$el,n=t.originalEvent.dataTransfer.getData("text/plain"),r=i("#"+n);o.isUndefined(n)||o.isEmpty(r)||e.attr("id")===n||this.instance_id!==r.attr("data-instance")||e.after(r),s.trigger("block:reorder:dropped",n)},handleBlockMouseOver:function(t){var e=i(t.currentTarget);e.hasClass("st-block--with-plus")||e.addClass("st-block--with-plus")},handleBlockMouseOut:function(t){var e=i(t.currentTarget);e.hasClass("st-block--with-plus")&&e.removeClass("st-block--with-plus")},handleBlockClick:function(t){t.stopPropagation(),this.mediator.trigger("block-controls:render",i(t.currentTarget))}}),e.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./event-bus":82,"./events":83,"./function-bind":92,"./lodash":97,"./renderable":99}],88:[function(t,e){"use strict";var n=t("./config"),o=t("./utils"),i=t("./event-bus"),s=t("./extensions/submittable"),r=!1,a={bindFormSubmit:function(t){r||(new s(t),t.bind("submit",this.onFormSubmit),r=!0)},onBeforeSubmit:function(t){var e=0;return n.instances.forEach(function(n){e+=n.onFormSubmit(t)}),o.log("Total errors: "+e),e},onFormSubmit:function(t){var e=a.onBeforeSubmit();e>0&&(i.trigger("onError"),t.preventDefault())}};e.exports=a},{"./config":79,"./event-bus":82,"./extensions/submittable":86,"./utils":103}],89:[function(t,e){(function(n){"use strict";var o=t("./lodash"),i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,s=t("./config"),r=t("./formatters"),a=function(t,e){this.options=Object.assign({},s.defaults.formatBar,t||{}),this.mediator=e,this._ensureElement(),this._bindFunctions(),this._bindMediatedEvents(),this.initialize.apply(this,arguments)};Object.assign(a.prototype,t("./function-bind"),t("./mediated-events"),t("./events"),t("./renderable"),{className:"st-format-bar",bound:["onFormatButtonClick","renderBySelection","hide"],eventNamespace:"formatter",mediatedEvents:{position:"renderBySelection",show:"show",hide:"hide"},initialize:function(){var t,e,n;this.$btns=[];for(t in r)r.hasOwnProperty(t)&&(e=r[t],n=i("<button>",{"class":"st-format-btn st-format-btn--"+t+" "+(e.iconName?"st-icon":""),text:e.text,"data-type":t,"data-cmd":e.cmd}),this.$btns.push(n),n.appendTo(this.$el));this.$b=i(document),this.$el.bind("click",".st-format-btn",this.onFormatButtonClick)},hide:function(){this.$el.removeClass("st-format-bar--is-ready")},show:function(){this.$el.addClass("st-format-bar--is-ready")},remove:function(){this.$el.remove()},renderBySelection:function(){var t=window.getSelection(),e=t.getRangeAt(0),n=e.getBoundingClientRect(),o={};o.top=n.top+20+window.pageYOffset-this.$el.height()+"px",o.left=(n.left+n.right)/2-this.$el.width()/2+"px",this.highlightSelectedButtons(),this.show(),this.$el.css(o)},highlightSelectedButtons:function(){var t;this.$btns.forEach(function(e){t=r[e.attr("data-type")],e.toggleClass("st-format-btn--is-active",t.isActive())},this)},onFormatButtonClick:function(t){t.stopPropagation();var e=i(t.target),n=r[e.attr("data-type")];return o.isUndefined(n)?!1:(!o.isUndefined(n.onClick)&&o.isFunction(n.onClick)?n.onClick():document.execCommand(e.attr("data-cmd"),!1,n.param),this.highlightSelectedButtons(),!1)}}),e.exports=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./config":79,"./events":83,"./formatters":91,"./function-bind":92,"./lodash":97,"./mediated-events":98,"./renderable":99}],90:[function(t,e){"use strict";var n=t("./lodash"),o=function(t){this.formatId=n.uniqueId("format-"),this._configure(t||{}),this.initialize.apply(this,arguments)},i=["title","className","cmd","keyCode","param","onClick","toMarkdown","toHTML"];Object.assign(o.prototype,{title:"",className:"",cmd:null,keyCode:null,param:null,toMarkdown:function(t){return t},toHTML:function(t){return t},initialize:function(){},_configure:function(t){this.options&&(t=Object.assign({},this.options,t));for(var e=0,n=i.length;n>e;e++){var o=i[e];t[o]&&(this[o]=t[o])}this.options=t},isActive:function(){return document.queryCommandState(this.cmd)},_bindToBlock:function(t){var e=this,n=!1;t.on("keyup",".st-text-block",function(t){(17===t.which||224===t.which||91===t.which)&&(n=!1)}).on("keydown",".st-text-block",{formatter:e},function(t){(17===t.which||224===t.which||91===t.which)&&(n=!0),t.which===t.data.formatter.keyCode&&n===!0&&(document.execCommand(t.data.formatter.cmd,!1,!0),t.preventDefault(),n=!1)})}}),o.extend=t("./helpers/extend"),e.exports=o},{"./helpers/extend":94,"./lodash":97}],91:[function(t,e,n){"use strict";var o=t("./formatter"),i=o.extend({title:"bold",cmd:"bold",keyCode:66,text:"B"}),s=o.extend({title:"italic",cmd:"italic",keyCode:73,text:"i"}),r=o.extend({title:"link",iconName:"link",cmd:"CreateLink",text:"link",onClick:function(){var t=window.prompt(i18n.t("general:link")),e=/((ftp|http|https):\/\/.)|mailto(?=\:[-\.\w]+@)/;t&&t.length>0&&(e.test(t)||(t="http://"+t),document.execCommand(this.cmd,!1,t))},isActive:function(){var t,e=window.getSelection();return e.rangeCount>0&&(t=e.getRangeAt(0).startContainer.parentNode),t&&"A"===t.nodeName}}),a=o.extend({title:"unlink",iconName:"link",cmd:"unlink",text:"link"});n.Bold=new i,n.Italic=new s,n.Link=new r,n.Unlink=new a},{"./formatter":90}],92:[function(t,e){"use strict";e.exports={bound:[],_bindFunctions:function(){this.bound.forEach(function(t){this[t]=this[t].bind(this)},this)}}},{}],93:[function(){(function(t){"use strict";function e(t){t.preventDefault()}function n(t){t.originalEvent.dataTransfer.dropEffect="copy",i(t.currentTarget).addClass("st-drag-over"),t.preventDefault()}function o(t){i(t.currentTarget).removeClass("st-drag-over"),t.preventDefault()}var i="undefined"!=typeof window?window.$:"undefined"!=typeof t?t.$:null;i.fn.dropArea=function(){return this.bind("dragenter",e).bind("dragover",n).bind("dragleave",o),this},i.fn.noDropArea=function(){return this.unbind("dragenter").unbind("dragover").unbind("dragleave"),this},i.fn.caretToEnd=function(){var t,e;return t=document.createRange(),t.selectNodeContents(this[0]),t.collapse(!1),e=window.getSelection(),e.removeAllRanges(),e.addRange(t),this}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],94:[function(t,e){"use strict";e.exports=function(t,e){var n,o=this;n=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return o.apply(this,arguments)},Object.assign(n,o,e);var i=function(){this.constructor=n};return i.prototype=o.prototype,n.prototype=new i,t&&Object.assign(n.prototype,t),n.__super__=o.prototype,n}},{}],95:[function(t,e){"use strict";var n=t("./lodash");t("object.assign").shim(),t("array.prototype.find"),t("./vendor/array-includes"),t("./helpers/event");var o={config:t("./config"),log:t("./utils").log,Locales:t("./locales"),Events:t("./events"),EventBus:t("./event-bus"),EditorStore:t("./extensions/editor-store"),Submittable:t("./extensions/submittable"),FileUploader:t("./extensions/file-uploader"),BlockMixins:t("./block_mixins"),BlockPositioner:t("./block-positioner"),BlockReorder:t("./block-reorder"),BlockDeletion:t("./block-deletion"),BlockValidations:t("./block-validations"),BlockStore:t("./block-store"),BlockManager:t("./block-manager"),SimpleBlock:t("./simple-block"),Block:t("./block"),Formatter:t("./formatter"),Formatters:t("./formatters"),Blocks:t("./blocks"),BlockControl:t("./block-control"),BlockControls:t("./block-controls"),FloatingBlockControls:t("./floating-block-controls"),FormatBar:t("./format-bar"),Editor:t("./editor"),toMarkdown:t("./to-markdown"),toHTML:t("./to-html"),setDefaults:function(t){Object.assign(o.config.defaults,t||{})},getInstance:function(t){return n.isUndefined(t)?this.config.instances[0]:n.isString(t)?this.config.instances.find(function(e){return e.ID===t}):this.config.instances[t]},setBlockOptions:function(t,e){var i=o.Blocks[t];n.isUndefined(i)||Object.assign(i.prototype,e||{})},runOnAllInstances:function(t){if(o.Editor.prototype.hasOwnProperty(t)){var e=Array.prototype.slice.call(arguments,1);Array.prototype.forEach.call(o.config.instances,function(n){n[t].apply(null,e)})}else o.log("method doesn't exist")}};Object.assign(o,t("./form-events")),e.exports=o},{"./block":63,"./block-control":55,"./block-controls":56,"./block-deletion":57,"./block-manager":58,"./block-positioner":59,"./block-reorder":60,"./block-store":61,"./block-validations":62,"./block_mixins":68,"./blocks":73,"./config":79,"./editor":80,"./event-bus":82,"./events":83,"./extensions/editor-store":84,"./extensions/file-uploader":85,"./extensions/submittable":86,"./floating-block-controls":87,"./form-events":88,"./format-bar":89,"./formatter":90,"./formatters":91,"./helpers/event":93,"./locales":96,"./lodash":97,"./simple-block":100,"./to-html":101,"./to-markdown":102,"./utils":103,"./vendor/array-includes":104,"array.prototype.find":2,"object.assign":51}],96:[function(t,e){"use strict";var n=t("./lodash"),o=t("./config"),i=t("./utils"),s={en:{general:{"delete":"Delete?",drop:"Drag __block__ here",paste:"Or paste URL here",upload:"...or choose a file",close:"close",position:"Position",wait:"Please wait...",link:"Enter a link"},errors:{title:"You have the following errors:",validation_fail:"__type__ block is invalid",block_empty:"__name__ must not be empty",type_missing:"You must have a block of type __type__",required_type_empty:"A required block type __type__ is empty",load_fail:"There was a problem loading the contents of the document"},blocks:{text:{title:"Text"},list:{title:"List"},quote:{title:"Quote",credit_field:"Credit"},image:{title:"Image",upload_error:"There was a problem with your upload"},video:{title:"Video"},tweet:{title:"Tweet",fetch_error:"There was a problem fetching your tweet"},embedly:{title:"Embedly",fetch_error:"There was a problem fetching your embed",key_missing:"An Embedly API key must be present"},heading:{title:"Heading"}}}};void 0===window.i18n?(i.log("Using i18n stub"),window.i18n={t:function(t,e){var i,r,a,l,c=t.split(":");for(r=s[o.language],l=0;l<c.length;l++)a=c[l],n.isUndefined(r[a])||(r=r[a]);return i=r,n.isString(i)?(i.indexOf("__")>=0&&Object.keys(e).forEach(function(t){i=i.replace("__"+t+"__",e[t])}),i):""}}):(i.log("Using i18next"),i18n.init({resStore:s,fallbackLng:o.language,ns:{namespaces:["general","blocks"],defaultNs:"general"}})),e.exports=s},{"./config":79,"./lodash":97,"./utils":103}],97:[function(t,e,n){"use strict";n.isEmpty=t("lodash.isempty"),n.isFunction=t("lodash.isfunction"),n.isObject=t("lodash.isobject"),n.isString=t("lodash.isstring"),n.isUndefined=t("lodash.isundefined"),n.result=t("lodash.result"),n.template=t("lodash.template"),n.uniqueId=t("lodash.uniqueid")},{"lodash.isempty":4,"lodash.isfunction":28,"lodash.isobject":29,"lodash.isstring":31,"lodash.isundefined":32,"lodash.result":33,"lodash.template":34,"lodash.uniqueid":50}],98:[function(t,e){"use strict";e.exports={mediatedEvents:{},eventNamespace:null,_bindMediatedEvents:function(){Object.keys(this.mediatedEvents).forEach(function(t){var e=this.mediatedEvents[t];t=this.eventNamespace?this.eventNamespace+":"+t:t,this.mediator.on(t,this[e].bind(this))},this)}}},{}],99:[function(t,e){(function(n){"use strict";var o=t("./lodash"),i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null;e.exports={tagName:"div",className:"sir-trevor__view",attributes:{},$:function(t){return this.$el.find(t)},render:function(){return this},destroy:function(){o.isUndefined(this.stopListening)||this.stopListening(),this.$el.remove()},_ensureElement:function(){if(this.el)this._setElement(this.el);else{var t,e=Object.assign({},o.result(this,"attributes"));this.id&&(e.id=this.id),this.className&&(e["class"]=this.className),e.html&&(t=e.html,delete e.html);var n=i("<"+this.tagName+">").attr(e);t&&n.html(t),this._setElement(n)}},_setElement:function(t){return this.$el=i(t),this.el=this.$el[0],this}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./lodash":97}],100:[function(t,e){(function(n){"use strict";var o=t("./lodash"),i=t("./utils"),s="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,r=t("./block-reorder"),a=function(t,e,n){this.createStore(t),this.blockID=o.uniqueId("st-block-"),this.instanceID=e,this.mediator=n,this._ensureElement(),this._bindFunctions(),this.initialize.apply(this,arguments)};Object.assign(a.prototype,t("./function-bind"),t("./events"),t("./renderable"),t("./block-store"),{focus:function(){},valid:function(){return!0},className:"st-block",block_template:o.template("<div class='st-block__inner'><%= editor_html %></div>"),attributes:function(){return{id:this.blockID,"data-type":this.type,"data-instance":this.instanceID}},title:function(){return i.titleize(this.type.replace(/[\W_]/g," "))},blockCSSClass:function(){return this.blockCSSClass=i.toSlug(this.type),this.blockCSSClass},type:"","class":function(){return i.classify(this.type)},editorHTML:"",initialize:function(){},onBlockRender:function(){},beforeBlockRender:function(){},_setBlockInner:function(){var t=o.result(this,"editorHTML");this.$el.append(this.block_template({editor_html:t})),this.$inner=this.$el.find(".st-block__inner"),this.$inner.bind("click mouseover",function(t){t.stopPropagation()})},render:function(){return this.beforeBlockRender(),this._setBlockInner(),this._blockPrepare(),this},_blockPrepare:function(){this._initUI(),this._initMessages(),this.checkAndLoadData(),this.$el.addClass("st-item-ready"),this.on("onRender",this.onBlockRender),this.save()},_withUIComponent:function(t,e,n){this.$ui.append(t.render().$el),e&&n&&this.$ui.on("click",e,n)},_initUI:function(){var t=s("<div>",{"class":"st-block__ui"});this.$inner.append(t),this.$ui=t,this._initUIComponents()},_initMessages:function(){var t=s("<div>",{"class":"st-block__messages"});this.$inner.prepend(t),this.$messages=t},addMessage:function(t,e){var n=s("<span>",{html:t,"class":"st-msg "+e});return this.$messages.append(n).addClass("st-block__messages--is-visible"),n},resetMessages:function(){this.$messages.html("").removeClass("st-block__messages--is-visible")},_initUIComponents:function(){this._withUIComponent(new r(this.$el))}}),a.fn=a.prototype,a.extend=t("./helpers/extend"),e.exports=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./block-reorder":60,"./block-store":61,"./events":83,"./function-bind":92,"./helpers/extend":94,"./lodash":97,"./renderable":99,"./utils":103}],101:[function(t,e){"use strict";var n=t("./lodash"),o=t("./utils");e.exports=function(e,i){var s=t("./blocks"),r=t("./formatters");i=o.classify(i);var a=e,l="Text"===i;n.isUndefined(l)&&(l=!1),l&&(a="<div>"+a),a=a.replace(/\[([^\]]+)\]\(([^\)]+)\)/gm,function(t,e,n){return"<a href='"+n+"'>"+e.replace(/\n/g,"")+"</a>"}),a=o.reverse(o.reverse(a).replace(/_(?!\\)((_\\|[^_])*)_(?=$|[^\\])/gm,function(t,e){return">i/<"+e.replace(/\n/g,"").replace(/[\s]+$/,"")+">i<"}).replace(/\*\*(?!\\)((\*\*\\|[^\*\*])*)\*\*(?=$|[^\\])/gm,function(t,e){return">b/<"+e.replace(/\n/g,"").replace(/[\s]+$/,"")+">b<"})),a=a.replace(/^\> (.+)$/gm,"$1");var c,d;for(c in r)r.hasOwnProperty(c)&&(d=r[c],!n.isUndefined(d.toHTML)&&n.isFunction(d.toHTML)&&(a=d.toHTML(a)));var u;return s.hasOwnProperty(i)&&(u=s[i],!n.isUndefined(u.prototype.toHTML)&&n.isFunction(u.prototype.toHTML)&&(a=u.prototype.toHTML(a))),l&&(a=a.replace(/\n\n/gm,"</div><div><br></div><div>"),a=a.replace(/\n/gm,"</div><div>")),a=a.replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;").replace(/\n/g,"<br>").replace(/\*\*/,"").replace(/__/,""),a=a.replace(/\\\*/g,"*").replace(/\\\[/g,"[").replace(/\\\]/g,"]").replace(/\\\_/g,"_").replace(/\\\(/g,"(").replace(/\\\)/g,")").replace(/\\\-/g,"-"),l&&(a+="</div>"),a}},{"./blocks":73,"./formatters":91,"./lodash":97,"./utils":103}],102:[function(t,e){"use strict";var n=t("./lodash"),o=t("./utils");e.exports=function(e,i){function s(t,e,o){return n.isUndefined(o)&&(o=""),"**"+e.replace(/<(.)?br(.)?>/g,"")+"**"+o}function r(t,e,o){return n.isUndefined(o)&&(o=""),"_"+e.replace(/<(.)?br(.)?>/g,"")+"_"+o}var a=t("./blocks"),l=t("./formatters");i=o.classify(i);var c=e;c=c.replace(/&nbsp;/g," "),c=c.replace(/( class=(")?Mso[a-zA-Z]+(")?)/g,"").replace(/<!--(.*?)-->/g,"").replace(/\/\*(.*?)\*\//g,"").replace(/<(\/)*(meta|link|span|\\?xml:|st1:|o:|font)(.*?)>/gi,"");var d,u,h=["style","script","applet","embed","noframes","noscript"];for(u=0;u<h.length;u++)d=new RegExp("<"+h[u]+".*?"+h[u]+"(.*?)>","gi"),c=c.replace(d,"");c=c.replace(/\*/g,"\\*").replace(/\[/g,"\\[").replace(/\]/g,"\\]").replace(/\_/g,"\\_").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\-/g,"\\-");var f=["em","i","strong","b"];for(u=0;u<f.length;u++)d=new RegExp("<"+f[u]+"><br></"+f[u]+">","gi"),c=c.replace(d,"<br>");c=c.replace(/<(\w+)(?:\s+\w+="[^"]+(?:"\$[^"]+"[^"]+)?")*>\s*<\/\1>/gim,"").replace(/\n/gm,"").replace(/<a.*?href=[""'](.*?)[""'].*?>(.*?)<\/a>/gim,function(t,e,n){return"["+n.trim().replace(/<(.)?br(.)?>/g,"")+"]("+e+")"}).replace(/<strong>(?:\s*)(.*?)(\s)*?<\/strong>/gim,s).replace(/<b>(?:\s*)(.*?)(\s*)?<\/b>/gim,s).replace(/<em>(?:\s*)(.*?)(\s*)?<\/em>/gim,r).replace(/<i>(?:\s*)(.*?)(\s*)?<\/i>/gim,r);var p,b;for(p in l)l.hasOwnProperty(p)&&(b=l[p],!n.isUndefined(b.toMarkdown)&&n.isFunction(b.toMarkdown)&&(c=b.toMarkdown(c)));c=c.replace(/([^<>]+)(<div>)/g,"$1\n$2").replace(/<div><div>/g,"\n<div>").replace(/(?:<div>)([^<>]+)(?:<div>)/g,"$1\n").replace(/(?:<div>)(?:<br>)?([^<>]+)(?:<br>)?(?:<\/div>)/g,"$1\n").replace(/<\/p>/g,"\n\n").replace(/<(.)?br(.)?>/g,"\n").replace(/&lt;/g,"<").replace(/&gt;/g,">");var m;return a.hasOwnProperty(i)&&(m=a[i],!n.isUndefined(m.prototype.toMarkdown)&&n.isFunction(m.prototype.toMarkdown)&&(c=m.prototype.toMarkdown(c))),c=c.replace(/<\/?[^>]+(>|$)/g,"")}},{"./blocks":73,"./formatters":91,"./lodash":97,"./utils":103}],103:[function(t,e){"use strict";var n=t("./lodash"),o=t("./config"),i=/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/,s={log:function(){!n.isUndefined(console)&&o.debug&&console.log.apply(console,arguments)},isURI:function(t){return i.test(t)},titleize:function(t){return null===t?"":(t=String(t).toLowerCase(),t.replace(/(?:^|\s|-)\S/g,function(t){return t.toUpperCase()}))},classify:function(t){return s.titleize(String(t).replace(/[\W_]/g," ")).replace(/\s/g,"")},capitalize:function(t){return t.charAt(0).toUpperCase()+t.substring(1).toLowerCase()},flatten:function(t){var e={};return(Array.isArray(t)?t:Object.keys(t)).forEach(function(t){e[t]=!0}),e},underscored:function(t){return t.trim().replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()},reverse:function(t){return t.split("").reverse().join("")},toSlug:function(t){return t.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-")}};e.exports=s},{"./config":79,"./lodash":97}],104:[function(){"use strict";[].includes||(Array.prototype.includes=function(t){if(void 0===this||null===this)throw new TypeError("Cannot convert this value to object");var e=Object(this),n=parseInt(e.length)||0;if(0===n)return!1;var o,i=parseInt(arguments[1])||0;for(i>=0?o=i:(o=n+i,0>o&&(o=0));n>o;){var s=e[o];if(t===s||t!==t&&s!==s)return!0;o++}return!1})},{}]},{},[1])(1)});
